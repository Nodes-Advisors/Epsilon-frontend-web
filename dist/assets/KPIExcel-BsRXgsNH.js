import{R as I,j as t,r as n,b as i}from"./index-lGblRe-B.js";import{a as u}from"./axios-G2rPRu76.js";import{C as y,r as W,a as K,L as Y,B as _,P as G,b as V,p as q,c as z,d as J,i as Q,e as U,f as X,D as Z}from"./index-gDgl4ywO.js";y.register(...W);y.register(K,Y,_,G,V,q,z,J,Q);const tt=()=>{const[c,D]=n.useState([]),[p,w]=n.useState([]),[C,O]=n.useState({}),[R,E]=n.useState(!0),[h,j]=n.useState([]),[et,T]=n.useState({}),[N,F]=n.useState({}),[S,k]=n.useState({}),[at,v]=n.useState({}),f={width:"40%",margin:"0 1%"},x={display:"flex",justifyContent:"space-around",padding:"20px"};n.useEffect(()=>{const e=async()=>{try{const o=await u.get(`http://${i}:5002/deals`);D(o.data)}catch(o){console.error("Error fetching deal data:",o)}},a=async()=>{try{const o=await u.get(`http://${i}:5002/account-holders`);w(o.data)}catch(o){console.error("Error fetching account holder data:",o)}};Promise.all([e(),a()]).then(()=>{E(!1)})},[]),n.useEffect(()=>{const e=c.map(r=>r.dealName),a=c.map(r=>r.totalOutreach),o=c.map(r=>r.newFund),d=c.map(r=>r.respondOrNot);O({labels:e,datasets:[{label:"Total Outreach",data:a,backgroundColor:"rgba(255, 99, 132, 1)",barThickness:"flex"},{label:"New Fund",data:o,backgroundColor:"rgba(54, 162, 235, 1)",barThickness:"flex"},{label:"Respond or Not",data:d,backgroundColor:"rgba(255, 206, 86, 1)",barThickness:"flex"}]})},[c]);const A={indexAxis:"y",elements:{bar:{borderWidth:1.5,minBarLength:2}},responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"white"}}},scales:{x:{ticks:{color:"white"}},y:{ticks:{color:"white",autoSkip:!1,maxRotation:0,minRotation:0}}}};n.useEffect(()=>{(async()=>{try{const a=await u.get(`http://${i}:5002/monthly-totals`);j(a.data)}catch(a){console.error("Error fetching monthly totals:",a)}})()},[]),n.useEffect(()=>{const e=h.map(r=>`${r.month}/${r.year}`),a=h.map(r=>r.totalOutreach),o=h.map(r=>r.totalNewFund),d=h.map(r=>r.totalResponse);T({labels:e,datasets:[{label:"Total Outreach",data:a,borderColor:"rgb(0, 123, 255)",backgroundColor:"rgba(0, 123, 255, 0.5)",fill:!1,tension:.1},{label:"Total New Fund",data:o,borderColor:"rgb(255, 193, 7)",backgroundColor:"rgba(255, 193, 7, 0.5)",fill:!1,tension:.1},{label:"Total Response",data:d,borderColor:"rgb(108, 117, 125)",backgroundColor:"rgba(108, 117, 125, 0.5)",fill:!1,tension:.1}]})},[h]);const $={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{x:{title:{display:!0,text:"Month"}},y:{title:{display:!0,text:"Count"}}}},L=e=>{const a=e.reduce((r,{accountHolder:l,month:s,year:b,totalOutreach:H})=>{const B=`${s}-${b}`;return r[l]||(r[l]={label:l,data:[],borderColor:g(),fill:!1,tension:.1}),r[l].data.push({monthYear:B,totalOutreach:H}),r},{});for(const r of Object.keys(a))a[r].data.sort((l,s)=>new Date(l.monthYear)-new Date(s.monthYear));const o=[...new Set(e.map(({month:r,year:l})=>`${r}-${l}`))].sort((r,l)=>new Date(r)-new Date(l)),d=Object.values(a).map(r=>({label:r.label,data:o.map(l=>{const s=r.data.find(b=>b.monthYear===l);return s?s.totalOutreach:null}),borderColor:r.borderColor,fill:r.fill,tension:r.tension}));return{labels:o,datasets:d}},g=()=>{const e="0123456789ABCDEF";let a="#";for(let o=0;o<6;o++)a+=e[Math.floor(Math.random()*16)];return a};n.useEffect(()=>{(async()=>{try{const a=await u.get(`http://${i}:5002/account-holder-kpis`),o=L(a.data);F(o)}catch(a){console.error("Error fetching account holder KPIs:",a)}})()},[]),n.useEffect(()=>{(async()=>{try{const a=await u.get(`http://${i}:5002/total-outreach-per-account-holder`),o=P(a.data);k(o)}catch(a){console.error("Error fetching total outreach per account holder:",a)}})()},[]);const P=e=>({labels:e.map(a=>a.accountHolder),datasets:[{data:e.map(a=>a.totalOutreach),backgroundColor:e.map(()=>g()),borderWidth:1}]});n.useEffect(()=>{(async()=>{try{const a=await u.get(`http://${i}:5002/monthly-totals`);j(a.data);const o=M(a.data);v(o)}catch(a){console.error("Error fetching monthly totals:",a)}})()},[]);const M=e=>{const a=e.map(s=>`${s.month}/${s.year}`),o=e.map(s=>s.totalOutreach),d=e.map(s=>s.totalNewFund),r=e.map(s=>s.totalResponse),l=e.map(s=>s.averageResponse);return{labels:a,datasets:[{type:"bar",label:"Total Outreach",data:o,backgroundColor:"rgba(53, 162, 235, 0.5)"},{type:"bar",label:"Total New Fund",data:d,backgroundColor:"rgba(75, 192, 192, 0.5)"},{type:"line",label:"Total Response",data:r,borderColor:"rgba(255, 99, 132, 1)",backgroundColor:"rgba(255, 99, 132, 0.5)",fill:!0},{type:"line",label:"Average Response",data:l,borderColor:"rgba(255, 205, 86, 1)",backgroundColor:"rgba(255, 205, 86, 0.5)",fill:!1}]}};return t.jsx("div",{children:R?t.jsx("p",{children:"Loading data..."}):t.jsxs("div",{children:[t.jsx("h2",{children:"Statistics for Each Deal"}),t.jsxs("div",{style:x,children:[t.jsxs("table",{style:f,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Deal Name"}),t.jsx("th",{children:"Total Outreach"}),t.jsx("th",{children:"New Fund"}),t.jsx("th",{children:"Respond or Not"})]})}),t.jsxs("tbody",{children:[c.map((e,a)=>t.jsxs("tr",{children:[t.jsx("td",{children:e.dealName}),t.jsx("td",{children:e.totalOutreach}),t.jsx("td",{children:e.newFund}),t.jsx("td",{children:e.respondOrNot})]},a)),t.jsxs("tr",{children:[t.jsx("td",{children:"Grand Total"}),t.jsx("td",{children:c.reduce((e,a)=>e+a.totalOutreach,0)}),t.jsx("td",{children:c.reduce((e,a)=>e+a.newFund,0)}),t.jsx("td",{children:c.reduce((e,a)=>e+a.respondOrNot,0)})]})]})]}),t.jsx("div",{style:{height:"800px",width:"950px"},children:t.jsx(U,{data:C,options:A})})]}),t.jsx("h2",{children:"Account Holders' KPI"}),t.jsxs("div",{style:x,children:[t.jsxs("table",{style:f,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Account Holder"}),t.jsx("th",{children:"Total Outreach"}),t.jsx("th",{children:"New Fund"}),t.jsx("th",{children:"Respond or Not"}),t.jsx("th",{children:"New Respond"})]})}),t.jsxs("tbody",{children:[p.map((e,a)=>t.jsxs("tr",{children:[t.jsx("td",{children:e.accountHolder}),t.jsx("td",{children:e.totalOutreach}),t.jsx("td",{children:e.newFund}),t.jsx("td",{children:e.respondOrNot}),t.jsx("td",{children:e.newRespond})]},a)),t.jsxs("tr",{children:[t.jsx("td",{children:"Grand Total"}),t.jsx("td",{children:p.reduce((e,a)=>e+a.totalOutreach,0)}),t.jsx("td",{children:p.reduce((e,a)=>e+a.newFund,0)}),t.jsx("td",{children:p.reduce((e,a)=>e+a.respondOrNot,0)}),t.jsx("td",{children:p.reduce((e,a)=>e+a.newRespond,0)})]})]})]}),t.jsx("div",{style:{height:"500px",width:"950px"},children:t.jsx(X,{data:N,options:$})})]}),t.jsx("div",{style:x,children:t.jsx("div",{children:t.jsx(Z,{data:S})})}),t.jsx("h2",{children:"Statistics for Each Month"}),t.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"flex-start",flexWrap:"wrap",gap:"20px"},children:[t.jsxs("div",{style:{flex:"1",minWidth:"300px"},children:[" ",t.jsxs("table",{style:{width:"100%"},children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Month"}),t.jsx("th",{children:"Total Outreach"}),t.jsx("th",{children:"Total New Fund"}),t.jsx("th",{children:"Total Response"})]})}),t.jsx("tbody",{children:h.map((e,a)=>t.jsxs("tr",{children:[t.jsx("td",{children:`${e.month}/${e.year}`}),t.jsx("td",{children:e.totalOutreach}),t.jsx("td",{children:e.totalNewFund}),t.jsx("td",{children:e.totalResponse})]},a))})]})]}),t.jsxs("div",{style:{flex:"2",minWidth:"300px"},children:[" ",t.jsx("div",{style:{height:"500px",width:"100%"}})]})]})]})})},m=document.getElementById("root");m&&I.render(t.jsx(tt,{}),m);
