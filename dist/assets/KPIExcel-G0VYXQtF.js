import{R as B,j as t,r as n}from"./index-0WR0Gjyr.js";import{a as i}from"./axios-G2rPRu76.js";import{C as m,r as I,a as W,L as K,B as Y,P as _,b as G,p as q,c as z,d as J,i as Q,e as U,f as V,D as X}from"./index-ANgrnRw_.js";m.register(...I);m.register(W,K,Y,_,G,q,z,J,Q);const Z=()=>{const[c,y]=n.useState([]),[u,D]=n.useState([]),[w,C]=n.useState({}),[O,R]=n.useState(!0),[h,b]=n.useState([]),[tt,T]=n.useState({}),[N,E]=n.useState({}),[F,k]=n.useState({}),[et,v]=n.useState({}),j={width:"40%",margin:"0 1%"},p={display:"flex",justifyContent:"space-around",padding:"20px"};n.useEffect(()=>{const e=async()=>{try{const r=await i.get("http://localhost:5002/deals");y(r.data)}catch(r){console.error("Error fetching deal data:",r)}},a=async()=>{try{const r=await i.get("http://localhost:5002/account-holders");D(r.data)}catch(r){console.error("Error fetching account holder data:",r)}};Promise.all([e(),a()]).then(()=>{R(!1)})},[]),n.useEffect(()=>{const e=c.map(o=>o.dealName),a=c.map(o=>o.totalOutreach),r=c.map(o=>o.newFund),d=c.map(o=>o.respondOrNot);C({labels:e,datasets:[{label:"Total Outreach",data:a,backgroundColor:"rgba(255, 99, 132, 1)",barThickness:"flex"},{label:"New Fund",data:r,backgroundColor:"rgba(54, 162, 235, 1)",barThickness:"flex"},{label:"Respond or Not",data:d,backgroundColor:"rgba(255, 206, 86, 1)",barThickness:"flex"}]})},[c]);const A={indexAxis:"y",elements:{bar:{borderWidth:1.5,minBarLength:2}},responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"white"}}},scales:{x:{ticks:{color:"white"}},y:{ticks:{color:"white",autoSkip:!1,maxRotation:0,minRotation:0}}}};n.useEffect(()=>{(async()=>{try{const a=await i.get("http://localhost:5002/monthly-totals");b(a.data)}catch(a){console.error("Error fetching monthly totals:",a)}})()},[]),n.useEffect(()=>{const e=h.map(o=>`${o.month}/${o.year}`),a=h.map(o=>o.totalOutreach),r=h.map(o=>o.totalNewFund),d=h.map(o=>o.totalResponse);T({labels:e,datasets:[{label:"Total Outreach",data:a,borderColor:"rgb(0, 123, 255)",backgroundColor:"rgba(0, 123, 255, 0.5)",fill:!1,tension:.1},{label:"Total New Fund",data:r,borderColor:"rgb(255, 193, 7)",backgroundColor:"rgba(255, 193, 7, 0.5)",fill:!1,tension:.1},{label:"Total Response",data:d,borderColor:"rgb(108, 117, 125)",backgroundColor:"rgba(108, 117, 125, 0.5)",fill:!1,tension:.1}]})},[h]);const S={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{x:{title:{display:!0,text:"Month"}},y:{title:{display:!0,text:"Count"}}}},L=e=>{const a=e.reduce((o,{accountHolder:l,month:s,year:x,totalOutreach:$})=>{const H=`${s}-${x}`;return o[l]||(o[l]={label:l,data:[],borderColor:f(),fill:!1,tension:.1}),o[l].data.push({monthYear:H,totalOutreach:$}),o},{});for(const o of Object.keys(a))a[o].data.sort((l,s)=>new Date(l.monthYear)-new Date(s.monthYear));const r=[...new Set(e.map(({month:o,year:l})=>`${o}-${l}`))].sort((o,l)=>new Date(o)-new Date(l)),d=Object.values(a).map(o=>({label:o.label,data:r.map(l=>{const s=o.data.find(x=>x.monthYear===l);return s?s.totalOutreach:null}),borderColor:o.borderColor,fill:o.fill,tension:o.tension}));return{labels:r,datasets:d}},f=()=>{const e="0123456789ABCDEF";let a="#";for(let r=0;r<6;r++)a+=e[Math.floor(Math.random()*16)];return a};n.useEffect(()=>{(async()=>{try{const a=await i.get("http://localhost:5002/account-holder-kpis"),r=L(a.data);E(r)}catch(a){console.error("Error fetching account holder KPIs:",a)}})()},[]),n.useEffect(()=>{(async()=>{try{const a=await i.get("http://localhost:5002/total-outreach-per-account-holder"),r=P(a.data);k(r)}catch(a){console.error("Error fetching total outreach per account holder:",a)}})()},[]);const P=e=>({labels:e.map(a=>a.accountHolder),datasets:[{data:e.map(a=>a.totalOutreach),backgroundColor:e.map(()=>f()),borderWidth:1}]});n.useEffect(()=>{(async()=>{try{const a=await i.get("http://localhost:5002/monthly-totals");b(a.data);const r=M(a.data);v(r)}catch(a){console.error("Error fetching monthly totals:",a)}})()},[]);const M=e=>{const a=e.map(s=>`${s.month}/${s.year}`),r=e.map(s=>s.totalOutreach),d=e.map(s=>s.totalNewFund),o=e.map(s=>s.totalResponse),l=e.map(s=>s.averageResponse);return{labels:a,datasets:[{type:"bar",label:"Total Outreach",data:r,backgroundColor:"rgba(53, 162, 235, 0.5)"},{type:"bar",label:"Total New Fund",data:d,backgroundColor:"rgba(75, 192, 192, 0.5)"},{type:"line",label:"Total Response",data:o,borderColor:"rgba(255, 99, 132, 1)",backgroundColor:"rgba(255, 99, 132, 0.5)",fill:!0},{type:"line",label:"Average Response",data:l,borderColor:"rgba(255, 205, 86, 1)",backgroundColor:"rgba(255, 205, 86, 0.5)",fill:!1}]}};return t.jsx("div",{children:O?t.jsx("p",{children:"Loading data..."}):t.jsxs("div",{children:[t.jsx("h2",{children:"Statistics for Each Deal"}),t.jsxs("div",{style:p,children:[t.jsxs("table",{style:j,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Deal Name"}),t.jsx("th",{children:"Total Outreach"}),t.jsx("th",{children:"New Fund"}),t.jsx("th",{children:"Respond or Not"})]})}),t.jsxs("tbody",{children:[c.map((e,a)=>t.jsxs("tr",{children:[t.jsx("td",{children:e.dealName}),t.jsx("td",{children:e.totalOutreach}),t.jsx("td",{children:e.newFund}),t.jsx("td",{children:e.respondOrNot})]},a)),t.jsxs("tr",{children:[t.jsx("td",{children:"Grand Total"}),t.jsx("td",{children:c.reduce((e,a)=>e+a.totalOutreach,0)}),t.jsx("td",{children:c.reduce((e,a)=>e+a.newFund,0)}),t.jsx("td",{children:c.reduce((e,a)=>e+a.respondOrNot,0)})]})]})]}),t.jsx("div",{style:{height:"800px",width:"950px"},children:t.jsx(U,{data:w,options:A})})]}),t.jsx("h2",{children:"Account Holders' KPI"}),t.jsxs("div",{style:p,children:[t.jsxs("table",{style:j,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Account Holder"}),t.jsx("th",{children:"Total Outreach"}),t.jsx("th",{children:"New Fund"}),t.jsx("th",{children:"Respond or Not"}),t.jsx("th",{children:"New Respond"})]})}),t.jsxs("tbody",{children:[u.map((e,a)=>t.jsxs("tr",{children:[t.jsx("td",{children:e.accountHolder}),t.jsx("td",{children:e.totalOutreach}),t.jsx("td",{children:e.newFund}),t.jsx("td",{children:e.respondOrNot}),t.jsx("td",{children:e.newRespond})]},a)),t.jsxs("tr",{children:[t.jsx("td",{children:"Grand Total"}),t.jsx("td",{children:u.reduce((e,a)=>e+a.totalOutreach,0)}),t.jsx("td",{children:u.reduce((e,a)=>e+a.newFund,0)}),t.jsx("td",{children:u.reduce((e,a)=>e+a.respondOrNot,0)}),t.jsx("td",{children:u.reduce((e,a)=>e+a.newRespond,0)})]})]})]}),t.jsx("div",{style:{height:"500px",width:"950px"},children:t.jsx(V,{data:N,options:S})})]}),t.jsx("div",{style:p,children:t.jsx("div",{children:t.jsx(X,{data:F})})}),t.jsx("h2",{children:"Statistics for Each Month"}),t.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"flex-start",flexWrap:"wrap",gap:"20px"},children:[t.jsxs("div",{style:{flex:"1",minWidth:"300px"},children:[" ",t.jsxs("table",{style:{width:"100%"},children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Month"}),t.jsx("th",{children:"Total Outreach"}),t.jsx("th",{children:"Total New Fund"}),t.jsx("th",{children:"Total Response"})]})}),t.jsx("tbody",{children:h.map((e,a)=>t.jsxs("tr",{children:[t.jsx("td",{children:`${e.month}/${e.year}`}),t.jsx("td",{children:e.totalOutreach}),t.jsx("td",{children:e.totalNewFund}),t.jsx("td",{children:e.totalResponse})]},a))})]})]}),t.jsxs("div",{style:{flex:"2",minWidth:"300px"},children:[" ",t.jsx("div",{style:{height:"500px",width:"100%"}})]})]})]})})},g=document.getElementById("root");g&&B.render(t.jsx(Z,{}),g);
