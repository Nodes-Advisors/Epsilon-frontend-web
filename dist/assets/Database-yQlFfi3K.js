import{r as n,a as O,b as R,j as t}from"./index-0WR0Gjyr.js";import{a as p}from"./axios-G2rPRu76.js";function N(){const[l,b]=n.useState(""),[x,r]=n.useState([]);n.useState([]);const[S,C]=n.useState([]),[f,c]=n.useState(1),[m,g]=n.useState({}),w=n.useRef(null),[j,F]=n.useState({}),[y,v]=n.useState([]),u=n.useRef(null),[E,k]=n.useState(!0),d=O(e=>e.token),i=R(e=>e.user);n.useEffect(()=>{if(l==="")return;(async a=>{const s=await p.get(`http://localhost:5001/getFields/${a}`,{headers:{"Content-Type":"application/json",Authorization:d,email:i==null?void 0:i.email}});v(s.data);const o={};for(const h of s.data){const D=await p.get(`http://localhost:5001/getUniqueValues/${a}/${h}`,{headers:{"Content-Type":"application/json",Authorization:d,email:i==null?void 0:i.email}});o[h]=D.data}F(o)})(l)},[l]),n.useEffect(()=>{if(l==="")return;const e=async(a,s)=>{const o=await p.get(`http://localhost:5001/getCollections/${a}`,{params:{page:s,pageSize:500,filters:JSON.stringify(m)},headers:{"Content-Type":"application/json",Authorization:d,email:i==null?void 0:i.email}});o.data.length===0&&k(!1),r(h=>[...h,...o.data])};console.log(f),e(l,f)},[l,f,m]);const z=e=>{g({...m,[e.target.name]:e.target.value}),r([]),c(1)},A=e=>{e.preventDefault()};return n.useEffect(()=>{(async()=>{const a=await p.get("http://localhost:5001/getCollections",{headers:{"Content-Type":"application/json",Authorization:d,email:i==null?void 0:i.email}});a.status===200&&C(a.data)})()},[]),t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"3rem"},children:[t.jsx("h1",{children:"Database"}),t.jsx("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",width:"70%"},onClick:e=>{c(1),b(e.target.innerText),r([])},children:S.map((e,a)=>t.jsx("button",{style:{padding:"1rem",fontSize:"1.5rem",borderRadius:"0.5rem",border:"none"},children:e},a))}),t.jsx("form",{onSubmit:A,ref:u,children:y.length>0&&y.map((e,a)=>t.jsxs("div",{children:[t.jsx("label",{children:e}),t.jsxs("select",{style:{width:"200px"},name:e,onChange:z,children:[t.jsx("option",{value:"",children:"All"}),j[e]&&j[e].map((s,o)=>t.jsx("option",{value:s,children:s},o))]})]},a))}),t.jsx("button",{onClick:()=>{g({}),c(1),r([]),u.current&&u.current.reset()},children:"Clear filter"}),t.jsxs("table",{style:{gap:"1rem",padding:"3rem",alignSelf:"start"},children:[t.jsx("thead",{children:t.jsx("tr",{children:(()=>{const e=new Set;return x.forEach(a=>{Object.keys(a).forEach(s=>e.add(s))}),Array.from(e).map((a,s)=>t.jsx("th",{style:{padding:"0 10px",maxWidth:"100px",wordWrap:"break-word"},children:a},s))})()})}),t.jsx("tbody",{children:x.map((e,a)=>t.jsx("tr",{children:Object.values(e).map((s,o)=>t.jsx("td",{style:{padding:"0 10px",maxWidth:"100px",wordWrap:"break-word"},children:s===!1?"False":s},o))},a))})]}),t.jsx("div",{className:"loading",ref:w,children:E?t.jsx("button",{onClick:()=>c(e=>e+1),children:"Load More"}):t.jsx("h2",{children:"no more data"})})]})}export{N as default};
