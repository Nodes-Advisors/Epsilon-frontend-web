import{r as n,a as z,c as O,j as t,b as p}from"./index-lGblRe-B.js";import{a as f}from"./axios-G2rPRu76.js";function N(){const[o,b]=n.useState(""),[g,l]=n.useState([]);n.useState([]);const[C,w]=n.useState([]),[m,c]=n.useState(1),[u,j]=n.useState({}),E=n.useRef(null),[S,F]=n.useState({}),[y,R]=n.useState([]),x=n.useRef(null),[D,$]=n.useState(!0),d=z(e=>e.token),i=O(e=>e.user);n.useEffect(()=>{if(o==="")return;(async a=>{const s=await f.get(`http://${p}:5001/getFields/${a}`,{headers:{"Content-Type":"application/json",Authorization:d,email:i==null?void 0:i.email}});R(s.data);const r={};for(const h of s.data){const k=await f.get(`http://${p}:5001/getUniqueValues/${a}/${h}`,{headers:{"Content-Type":"application/json",Authorization:d,email:i==null?void 0:i.email}});r[h]=k.data}F(r)})(o)},[o]),n.useEffect(()=>{if(o==="")return;const e=async(a,s)=>{const r=await f.get(`http://${p}:5001/getCollections/${a}`,{params:{page:s,pageSize:500,filters:JSON.stringify(u)},headers:{"Content-Type":"application/json",Authorization:d,email:i==null?void 0:i.email}});r.data.length===0&&$(!1),l(h=>[...h,...r.data])};console.log(m),e(o,m)},[o,m,u]);const v=e=>{j({...u,[e.target.name]:e.target.value}),l([]),c(1)},A=e=>{e.preventDefault()};return n.useEffect(()=>{(async()=>{const a=await f.get(`http://${p}:5001/getCollections`,{headers:{"Content-Type":"application/json",Authorization:d,email:i==null?void 0:i.email}});a.status===200&&w(a.data)})()},[]),t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"3rem"},children:[t.jsx("h1",{children:"Database"}),t.jsx("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",width:"70%"},onClick:e=>{c(1),b(e.target.innerText),l([])},children:C.map((e,a)=>t.jsx("button",{style:{padding:"1rem",fontSize:"1.5rem",borderRadius:"0.5rem",border:"none"},children:e},a))}),t.jsx("form",{onSubmit:A,ref:x,children:y.length>0&&y.map((e,a)=>t.jsxs("div",{children:[t.jsx("label",{children:e}),t.jsxs("select",{style:{width:"200px"},name:e,onChange:v,children:[t.jsx("option",{value:"",children:"All"}),S[e]&&S[e].map((s,r)=>t.jsx("option",{value:s,children:s},r))]})]},a))}),t.jsx("button",{onClick:()=>{j({}),c(1),l([]),x.current&&x.current.reset()},children:"Clear filter"}),t.jsxs("table",{style:{gap:"1rem",padding:"3rem",alignSelf:"start"},children:[t.jsx("thead",{children:t.jsx("tr",{children:(()=>{const e=new Set;return g.forEach(a=>{Object.keys(a).forEach(s=>e.add(s))}),Array.from(e).map((a,s)=>t.jsx("th",{style:{padding:"0 10px",maxWidth:"100px",wordWrap:"break-word"},children:a},s))})()})}),t.jsx("tbody",{children:g.map((e,a)=>t.jsx("tr",{children:Object.values(e).map((s,r)=>t.jsx("td",{style:{padding:"0 10px",maxWidth:"100px",wordWrap:"break-word"},children:s===!1?"False":s},r))},a))})]}),t.jsx("div",{className:"loading",ref:E,children:D?t.jsx("button",{onClick:()=>c(e=>e+1),children:"Load More"}):t.jsx("h2",{children:"no more data"})})]})}export{N as default};
